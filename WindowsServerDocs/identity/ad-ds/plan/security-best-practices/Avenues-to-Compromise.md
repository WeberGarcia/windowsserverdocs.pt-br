---
ms.assetid: d7a4d2e1-217d-4ffc-93f0-817149bd9e7f
title: Caminhos para comprometer
description: 
author: billmath
ms.author: billmath
manager: femila
ms.date: 05/31/2017
ms.topic: article
ms.prod: windows-server-threshold
ms.technology: identity-adds
ms.openlocfilehash: 149a3e4bb2ce4558e40425e42ecfdeec2c5dfcb7
ms.sourcegitcommit: 78d8839ccafa9530784cb9e38c3127ed2c215423
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 01/09/2018
---
# <a name="avenues-to-compromise"></a>Caminhos para comprometer

>Aplica-se a: Windows Server 2016, Windows Server 2012 R2, Windows Server 2012

*Lei número sete: A rede mais segura é um bom administrado.* - [10 leis imutáveis de administração de segurança](https://technet.microsoft.com/library/cc722488.aspx)  
  
Organizações que já tenha ficado comprometimento catastrófico eventos, avaliações revelam geralmente que as organizações têm limitado visibilidade sobre o estado real de seus infraestruturas IT, que podem diferir significativamente seus estados "conforme documentado". Essas variações introduzem vulnerabilidades que expõem o ambiente de comprometer, geralmente com pouco risco de descoberta até que o comprometimento evoluiu para o ponto em que os invasores efetivamente "proprietário" o ambiente.  
  
Avaliações detalhadas de configuração do AD DS essas organizações, infraestruturas de chave pública (PKI), servidores, estações de trabalho, aplicativos, acessar listas de controle (ACLs), e outras tecnologias de revelam incorretas e vulnerabilidades que, se remediadas, poderiam ter evitado o comprometimento inicial.  
  
Análise de documentação, processos e procedimentos IT identifica vulnerabilidades introduzidas pela lacunas práticas administrativas que foram aproveitados por invasores, eventualmente, obter privilégios que foram usados para comprometer totalmente da floresta do Active Directory. Uma floresta totalmente comprometida é aquele em que os invasores comprometer não somente sistemas individuais, aplicativos ou contas de usuário, mas encaminhar o acesso para obter um nível de privilégio em que eles podem modificar ou destruir todos os aspectos da floresta. Quando uma instalação do Active Directory foi comprometida para que grau, os invasores podem fazer alterações que permitam manter uma presença em todo o ambiente, ou pior, para destruir o diretório e as contas que gerencia e sistemas.  
  
Embora algumas das vulnerabilidades comumente exploradas nas descrições que seguem não sejam ataques contra do Active Directory, eles permitem que os invasores estabelecer um destaque em um ambiente que pode ser usado para executar ataques de elevação (também chamada de elevação de privilégio) de privilégio para direcionar eventualmente e comprometer o AD DS.  
  
Esta seção deste documento se concentra em descrevendo os mecanismos que os invasores normalmente usam para acessar a infraestrutura e, eventualmente, para iniciar ataques de elevação de privilégio. Consulte também as seções a seguir:  
  
-   [Reduzir a superfície de ataque Active Directory](../../../ad-ds/plan/security-best-practices/../../../ad-ds/plan/security-best-practices/../../../ad-ds/plan/security-best-practices/Reducing-the-Active-Directory-Attack-Surface.md) detalhado recomendações para a configuração segura do Active Directory.  
  
-   [O monitoramento do Active Directory de sinais de comprometer](../../../ad-ds/plan/security-best-practices/Monitoring-Active-Directory-for-Signs-of-Compromise.md) recomendações para ajudar a detectar comprometimento  
  
-   [Planejamento de comprometimento](../../../ad-ds/plan/security-best-practices/../../../ad-ds/plan/security-best-practices/Planning-for-Compromise.md) abordagens de alto nível para ajudar a preparar para ataques contra a infraestrutura de IT e perspectivas de negócios  
  
> [!NOTE]  
> Embora este documento se concentra em sistemas do Active Directory e do Windows que fazem parte de um domínio do AD DS, os invasores raramente concentre-se exclusivamente no Active Directory e do Windows. Em ambientes com uma mistura de sistemas operacionais, diretórios, aplicativos e repositórios de dados, é comum para encontrar o que também tem sido comprometidos sistemas não Windows. Isso é especialmente verdadeiro se os sistemas fornecem uma "ponte" entre o Windows e não Windows ambientes, como servidores de arquivos acessado pelo Windows e UNIX ou clientes Linux, diretórios que fornecem serviços de autenticação para vários sistemas operacionais ou metadirectories que sincronizar dados em diretórios diferentes.  
>   
> AD DS é direcionada por causa centralizado acesso e configuração de recursos de gerenciamento fornece não só para sistemas Windows, mas para outros clientes. Qualquer outro diretório ou aplicativo que fornece autenticação e a configuração de serviços de gerenciamento pode e irá ser atacado por invasores determinados. Embora este documento é voltado para proteções que podem reduzir a probabilidade de um comprometimento de instalações do Active Directory, cada organização que inclui computadores sem Windows, diretórios, aplicativos ou dados repositórios também devem preparar para ataques contra esses sistemas.  
  
## <a name="initial-breach-targets"></a>Alvos de violação inicial  
Ninguém intencionalmente cria uma infraestrutura de TI que expõe a organização de comprometer. Quando uma floresta do Active Directory é construída pela primeira vez, geralmente é original e atual. Como passam anos e novos sistemas operacionais e aplicativos são adquiridos, eles são adicionados à floresta. Como os benefícios de gerenciamento do Active Directory fornece são reconhecidos, cada vez mais conteúdo é adicionado à pasta, mais pessoas integrarem seus computadores ou aplicativos com o AD DS e domínios são atualizados para dar suporte à nova funcionalidade oferecida pelas versões mais atuais do sistema operacional Windows. Além disso, o que acontece ao longo do tempo, no entanto, é que mesmo quando uma nova infraestrutura está sendo adicionado, outras partes da infraestrutura de não ser mantidos, assim como eles estavam inicialmente, sistemas e aplicativos estejam funcionando corretamente e, portanto, não estão recebendo atenção e organizações começam esquecer que eles não tiverem eliminado sua infraestrutura herdada. Com base no que vemos na avaliação infraestruturas comprometidas, o mais antigos, maior e mais complexo o ambiente, mais provável é que há várias instâncias de vulnerabilidades comumente exploradas.  
  
Independentemente da motivação do invasor, a maioria das violações de segurança das informações começam com o comprometimento de um ou dois sistemas de cada vez. Esses eventos iniciais ou pontos de entrada à rede, geralmente aproveitam vulnerabilidades que poderiam ter foi corrigidas, mas não eram. O [2012 dados violação investigações relatório (DBIR)](http://www.verizonbusiness.com/resources/reports/rp_data-breach-investigations-report-2012_en_xg.pdf), que é um estudo anual produzido pela equipe de risco da Verizon em cooperação com um número de agências de segurança nacional e outras empresas, estados que 96% dos ataques foram "não altamente difícil" e que "97% dos violações foram evitáveis por meio de controles simples ou intermediários." Essas descobertas podem ser uma consequência direta das vulnerabilidades comumente exploradas que seguem.  
  
### <a name="gaps-in-antivirus-and-antimalware-deployments"></a>Lacunas em implantações de Antimalware e antivírus  
*Lei número oito: um scanner de malware desatualizados é apenas um pouco melhor do que nenhum scanner em todos.* - [Dez leis imutáveis de segurança (versão 2.0)](https://technet.microsoft.com/security/hh278941.aspx)  
  
Análise das implantações de antivírus e antimalware das organizações revela muitas vezes um ambiente em que a maioria das estações de trabalho são configurados com um software antivírus e antimalware que está habilitado e atual. Exceções são geralmente estações de trabalho que se conectam com pouca frequência para dispositivos corporativos do ambiente ou funcionário, para qual antivírus e antimalware software pode ser difícil para implantar, configurar e atualizar.  
  
População de servidor, no entanto, tende a ser que menos protegido consistentemente em muitos ambientes comprometidos. Como informado no [investigações de violação de dados de 2012](http://www.verizonbusiness.com/resources/reports/rp_data-breach-investigations-report-2012_en_xg.pdf)94% de todos os dados compromete envolvidos servidores, que representa um aumento de 18% no ano anterior e incorporados de 69% dos ataques de malware. População de servidor, não é incomum localizar que instalações antivírus e antimalware são configuradas de forma inconsistente, desatualizadas, definidas incorretamente ou até mesmo desabilitadas. Em alguns casos, o software antivírus e antimalware está desabilitado por equipe administrativa, mas em outros casos, os invasores desabilitem o software após comprometer um servidor por meio de outras vulnerabilidades. Quando o software antivírus e antimalware está desabilitado, os invasores, em seguida, plante malware no servidor e focalizar propagar comprometimento entre a população de servidor.  
  
É importante não só para garantir que seus sistemas são protegidos com proteção contra malware atual, abrangente, mas também para monitorar sistemas de desativação ou remoção de software antivírus e antimalware e proteção seja reiniciado automaticamente quando ele estiver desabilitado manualmente. Embora nenhum software antivírus e antimalware pode garantir prevenção e detecção de infecções todos, uma implementação de antivírus e antimalware implantada e configurada corretamente pode reduzir a probabilidade de infecção.  
  
### <a name="incomplete-patching"></a>Aplicação de patch incompleta  
*Lei número três: se você não acompanhar correções de segurança, sua rede não será sua por muito tempo.* - [10 leis imutáveis de administração de segurança](https://technet.microsoft.com/library/cc722488.aspx)  
  
A Microsoft lança boletins de segurança na segunda terça-feira de cada mês, embora em raras ocasiões atualizações de segurança são lançadas entre as atualizações de segurança mensais (eles também são conhecidos como atualizações "out-of-band") quando a vulnerabilidade é determinada para representar um risco urgente para sistemas do cliente. Se uma pequena empresa configura seus computadores com Windows para usar o Windows Update para gerenciar o sistema e aplicação de patches ou uma grande organização usa software de gerenciamento, como o System Center Configuration Manager (SCCM) para implantar patches de acordo com os planos detalhados, hierárquicos, muitos clientes patch suas infraestruturas do Windows em tempo hábil relativamente.  
  
No entanto, alguns infraestruturas incluem somente a computadores com o Windows e aplicativos da Microsoft e em ambientes comprometidos, é comum para encontrar a estratégia de gerenciamento de patches da organização contém lacunas. Sistemas Windows nesses ambientes forma inconsistente sejam corrigidos. Sistemas operacionais Windows não são corrigidos esporadicamente, se alguma. Os aplicativos (COTS) disponíveis no mercado comerciais conter vulnerabilidades para os quais patches existem, mas não foram aplicados. Dispositivos de rede geralmente são configurados com credenciais padrão de fábrica e nenhum firmware anos após a instalação de atualizações. Aplicativos e sistemas operacionais que não são mais suportados por seus fornecedores geralmente são mantidos em execução, apesar do fato de que eles não podem ser corrigidos contra vulnerabilidades. Cada um desses sistemas sem patch representa outro ponto de entrada potencial para invasores.  
  
O consumo de IT foi introduzidos desafios adicionais no funcionário proprietária dispositivos estão sendo usados para acessar dados corporativos de exclusividade e a organização não pode ter pouco ou nenhum controle sobre a aplicação de patch e configuração de dispositivos pessoais dos funcionários. Hardware de classe empresarial normalmente é fornecido com opções de configuração pronto para empresa e recursos de gerenciamento, ao custo menor opção na seleção de personalização e o dispositivo individual. Hardware focado funcionário oferece uma variedade mais ampla de fabricantes, fornecedores, recursos de segurança de hardware, recursos de segurança de software, recursos de gerenciamento e as opções de configuração e muitos recursos empresariais podem estar totalmente ausentes.  
  
#### <a name="patch-and-vulnerability-management-software"></a>Patch e Software de gerenciamento de vulnerabilidade  
Se for um sistema de gerenciamento de patches eficaz no local para os sistemas Windows e aplicativos da Microsoft, parte da superfície de ataque que criar vulnerabilidades sem patch foi resolvido. No entanto, a menos que os sistemas não são do Windows, aplicativos não Microsoft, infraestrutura de rede e dispositivos dos funcionários também ficam sempre atualizados sobre patches e outras correções, a infraestrutura permanece vulnerável. Em alguns casos, o fornecedor do aplicativo pode oferecer recursos de atualização automática; em outros, pode haver a necessidade de planejar uma abordagem para recuperar e aplicar patches e outras correções regularmente.
  
### <a name="outdated-applications-and-operating-systems"></a>Sistemas operacionais e aplicativos desatualizados  
*"Você não pode esperar um sistema operacional de seis anos a se proteger contra um ataque de seis-mês-antigo".* -Information segurança Professional com 10 anos de experiência de fixação instalações enterprise  
  
Embora "obter atual, manter em dia" pode parecer como uma frase de marketing, desatualizados sistemas operacionais e aplicativos criam risco em muitas organizações infraestruturas IT. Um sistema operacional que foi lançado em 2003 ainda podem ser aceitos pelo fornecedor e fornecido com as atualizações de vulnerabilidades de endereço, mas esse sistema operacional não podem conter recursos de segurança adicionados em versões mais recentes do sistema operacional. Sistemas desatualizados ainda podem exigir relacionadas à diminuição de determinada configuração de segurança do AD DS para dar suporte os recursos menor desses computadores.  
  
Aplicativos que foram escritos para usar protocolos de autenticação herdados por fornecedores que são não suportará mais o aplicativo normalmente não podem ser alterados para dar suporte a mecanismos de autenticação mais fortes. No entanto, o domínio do Active Directory da organização ainda pode ser configurado para armazenar hashes do LAN Manager ou senhas com criptografia reversível para dar suporte a esses aplicativos. Aplicativos criados antes da introdução de sistemas operacionais mais recentes podem não funcionar bem ou sequer em sistemas operacionais, exigir que as organizações manter sistemas mais antigos e mais antigos e em alguns casos, completamente sem suporte de hardware e software.  
  
Até mesmo em casos em que as organizações atualizaram seus controladores de domínio para o Windows Server 2012, Windows Server 2008 R2 ou Windows Server 2008, é comum para encontrar partes significativas do membro população do servidor esteja executando o Windows Server 2003 (que não está mais em suporte base), ou até mesmo Windows 2000 Server ou o Windows NT Server 4.0 (que estão completamente sem suporte). Quanto mais uma organização mantém os sistemas de duração, quanto mais cresce disparidade entre conjuntos de recursos, e mais provável fica que sistemas de produção será sem suporte. Além disso, quanto mais uma floresta do Active Directory é mantida, quanto mais observamos que aplicativos e sistemas herdados são perdidos em planos de atualização. Isso pode significar que um único computador executando um único aplicativo pode introduzir vulnerabilidades de domínio ou floresta porque o Active Directory está configurado para dar suporte a seus protocolos herdados e mecanismos de autenticação.  
  
Para eliminar aplicativos e sistemas herdados, primeiro concentre-se na identificação e catálogos-los e sobre como determinar se é necessário atualizar ou substituir o aplicativo ou host. Embora possa ser difícil encontrar as substituições para aplicativos altamente especializados para os quais há suporte nem um caminho de atualização, você poderá aproveitar um conceito chamado "destruição criativa" para substituir o aplicativo herdado por um novo aplicativo que fornece a funcionalidade necessária. [Planejamento de comprometimento](../../../ad-ds/plan/security-best-practices/../../../ad-ds/plan/security-best-practices/Planning-for-Compromise.md) é descrito mais detalhadamente em "Planejamento comprometimento" no final deste documento.  
  
### <a name="misconfiguration"></a>Definição incorreta  
*Lei número quatro: ele não faz muito bom para instalar correções de segurança em um computador que nunca tenha sido protegido em primeiro lugar.* - [10 leis imutáveis de administração de segurança](https://technet.microsoft.com/library/cc722488.aspx)  
  
Até mesmo em ambientes onde sistemas geralmente são mantidos atuais e corrigidas, nós comumente identificar lacunas ou configurações incorretas no sistema operacional, aplicativos executados em computadores e Active Directory. Algumas configurações incorretas de expõem somente no computador local para comprometer, mas depois que um computador é "propriedade", os invasores normalmente focalizar propagar mais o comprometimento em outros sistemas e eventualmente ao Active Directory. Eis algumas das áreas comuns em que podemos identificar configurações que apresentam risco.  
  
#### <a name="in-active-directory"></a>No Active Directory  
As contas no Active Directory que são mais comumente atacadas por invasores são aqueles que são membros dos grupos da maioria altamente privilegiados, como membros dos administradores de domínio (DA), administradores de empresa (EA) ou grupos de administradores (BA) interno no Active Directory. A associação desses grupos deve ser reduzida para o menor número de contas possíveis para que a superfície de ataque desses grupos é limitada. É possível até mesmo eliminar "permanente" associação nesses grupos privilegiados; ou seja, você pode implementar as configurações que permitem que você temporariamente preencher esses grupos somente quando seus privilégios de domínio e floresta são necessárias. Quando as contas altamente privilegiadas são usadas, deve ser usados apenas em sistemas designados, seguros, como controladores de domínio ou hosts administrativos seguros. Informações detalhadas para ajudar a implementar todas essas configurações são fornecidas nas [reduzindo a superfície de ataque Active Directory](../../../ad-ds/plan/security-best-practices/../../../ad-ds/plan/security-best-practices/../../../ad-ds/plan/security-best-practices/Reducing-the-Active-Directory-Attack-Surface.md).  
  
Quando avaliamos a associação dos grupos privilegiados mais altos no Active Directory, comumente achamos excessiva associação em todos os três dos grupos mais privilégios. Em alguns casos, as organizações têm dezenas, até mesmo centenas de contas em grupos DA. Em outros casos, as organizações coloque contas diretamente em grupos de administradores internos, pensando que esse grupo é "menos privilegiados" que o grupo DAs. Não é. Encontramos muitas vezes alguns permanentes membros do grupo EA no domínio raiz da floresta, apesar do fato de que os privilégios do EA raramente são necessários e temporariamente. Localizar um IT diárias administrativas conta de usuário em todos os três grupos também é comum, mesmo que essa é uma configuração efetivamente redundante. Conforme descrito em [reduzindo a superfície de ataque Active Directory](../../../ad-ds/plan/security-best-practices/../../../ad-ds/plan/security-best-practices/../../../ad-ds/plan/security-best-practices/Reducing-the-Active-Directory-Attack-Surface.md), se uma conta é um membro permanente de um desses grupos ou todos eles, a conta pode ser usada para comprometer e até mesmo destruir o ambiente AD DS e os sistemas e contas gerenciadas por ele. Recomendações para a configuração segura e o uso de contas privilegiadas no Active Directory são fornecidas em [reduzindo a superfície de ataque Active Directory](../../../ad-ds/plan/security-best-practices/../../../ad-ds/plan/security-best-practices/../../../ad-ds/plan/security-best-practices/Reducing-the-Active-Directory-Attack-Surface.md).  
  
#### <a name="on-domain-controllers"></a>Em controladores de domínio  
Quando nós avaliamos controladores de domínio, encontramos muitas vezes encontrá-los configurados e gerenciados não diferente servidores membro. Controladores de domínio, às vezes, executam os mesmos aplicativos e utilitários instalados em servidores membros, não porque eles são necessários nos controladores de domínio, mas porque os aplicativos fazem parte de uma compilação padrão. Esses aplicativos podem fornecer funcionalidade mínima nos controladores de domínio, mas adicionar significativamente a sua superfície de ataque exigindo configuração que abra portas, criar contas de serviço privilegiado ou conceder acesso ao sistema, os usuários não devem se conectar a um controlador de domínio para propósitos diferentes de autenticação e aplicação de políticas de grupo. Em alguns violações, os invasores usou ferramentas que já foram instaladas em controladores de domínio não só para acessar os controladores de domínio, mas para modificar ou danificar o banco de dados do AD DS.  
  
Quando nós extrair as configurações do Internet Explorer em controladores de domínio, achamos que os usuários fez logon com contas que têm altos níveis de privilégio no Active Directory e usaram as contas para acessar a Internet e a intranet dos controladores de domínio. Em alguns casos, as contas configurou as configurações do Internet Explorer nos controladores de domínio para permitir o download do Internet conteúdo e utilitários gratuitos foram baixados de sites da Internet e instalados nos controladores de domínio. A configuração de segurança aprimorada do Internet Explorer está habilitada para usuários e administradores por padrão, mas geralmente observamos ou seja foi desabilitado para administradores. Quando uma conta altamente privilegiada acessa a Internet e baixa o conteúdo em qualquer computador, esse computador é colocar em risco grave. Quando o computador é um controlador de domínio, a instalação do AD DS inteira é colocar em risco.  
  
##### <a name="protecting-domain-controllers"></a>Proteger controladores de domínio  
Controladores de domínio devem ser tratados como componentes de infraestrutura críticos, protegidos de forma mais rigorosa e definidos mais rigidamente do arquivo, imprimir e servidores de aplicativos. Controladores de domínio não devem executar qualquer software que não é necessária para o controlador de domínio a função ou não protege o controlador de domínio contra ataques. Controladores de domínio não devem ter permissão para acessar a Internet e as configurações de segurança devem ser configuradas e impostas pelos objetos de política de grupo (GPOs). Recomendações detalhadas para a instalação segura, configuração e gerenciamento dos controladores de domínio são fornecidas em [proteger controladores de domínio contra ataques](../../../ad-ds/plan/security-best-practices/Securing-Domain-Controllers-Against-Attack.md).  
  
#### <a name="within-the-operating-system"></a>Dentro do sistema operacional  
*Lei número dois: se um mal-intencionada pode alterar o sistema operacional no computador, ele não é mais o seu computador.* - [Dez leis imutáveis de segurança (versão 2.0)](https://technet.microsoft.com/security/hh278941.aspx)  
  
Embora algumas organizações criar configurações de linha de base para servidores de diferentes tipos e permitem personalização limitada do sistema operacional após a instalação, análise dos ambientes comprometidos muitas vezes revela o grande número de servidores implantado de maneira ad-hoc e configurado de forma independente e manualmente. As configurações entre dois servidores que executam a mesma função podem ser completamente diferentes, onde nenhuma servidor está configurado com segurança. Por outro lado, linhas de base de configuração de servidor podem ser aplicadas de maneira consistente, mas também consistentemente definidas incorretamente; ou seja, os servidores são configurados de forma que cria a mesma vulnerabilidade em todos os servidores de um determinado tipo. Definição incorreta inclui práticas tal como desativando recursos de segurança, concedendo direitos excessivos e permissões às contas (especialmente contas de serviço), uso de credenciais locais idênticas em todos os sistemas e autorizar instalação de aplicativos não autorizados e utilitários que criam vulnerabilidades de seus próprios.  
  
##### <a name="disabling-security-features"></a>Desativando recursos de segurança  
As organizações, às vezes, desabilitar o Firewall do Windows com segurança avançada (WFAS) sem uma crença que WFAS é difícil configurar ou requer configuração com uso intensivo de trabalho. No entanto, a partir do Windows Server 2008, quando qualquer função ou recurso é instalado em um servidor, ela está configurada por padrão com os privilégios mínimos necessários para a função ou recurso à função e o Firewall do Windows é configurado automaticamente para dar suporte a função ou recurso. Desabilitando WFAS (e não usando outro firewall com base em host em seu lugar), as organizações aumentar a superfície de ataque de todo o ambiente do Windows. Firewalls de perímetro fornecem proteção contra ataques que voltada diretamente para um ambiente da Internet, mas eles fornecem nenhuma proteção contra ataques que explorar outros vetores de ataque como [download drive-by](https://www.microsoft.com/security/sir/glossary/drive-by-download-sites.aspx) ataques ou ataques originados outras comprometida sistemas na intranet.  
  
Configurações de controle de conta (UAC) de usuário às vezes são desabilitadas em servidores porque equipe administrativa encontra os prompts intrusivas. Embora [artigo Microsoft Support 2526083](https://support.microsoft.com/kb/2526083) descreve cenários em que o UAC pode ser desabilitado no Windows Server, a menos que você está executando um servidor de instalação de núcleo (onde o UAC estiver desabilitado por design), você não deve desabilitar o UAC em servidores sem cuidadosa consideração e pesquisa.  
  
Em outros casos, as configurações do servidor são configuradas para menos seguros valores porque as organizações aplicam configurações de servidor desatualizados a novos sistemas operacionais, como a aplicação de linhas de base do Windows Server 2003 para computadores que executam o Windows Server 2012, Windows Server 2008 R2 ou Windows Server 2008, sem alterar as linhas de base para refletir as alterações no sistema operacional. Em vez de realizar antigo linhas de base do servidor para novos sistemas operacionais, ao implantar um novo sistema operacional, examine as alterações de segurança e as configurações para garantir que as configurações implementadas são aplicáveis e apropriadas para o novo sistema operacional.  
  
##### <a name="granting-excessive-privilege"></a>Concedendo privilégios excessivos  
Em quase todos os ambientes que podemos ter avaliado, privilégio excessivo é concedido às contas locais e baseado em domínio em sistemas Windows. Os usuários recebem direitos de administrador local em suas estações de trabalho, servidores membros executam serviços que estejam configurados com direitos além do que eles precisam funcionar e grupos de administradores locais entre a população de servidor contêm dezenas ou até mesmo centenas de locais e contas de domínio. Comprometimento de apenas uma conta com privilégios em um computador permite que os invasores de comprometer as contas de cada usuário e o serviço que fizer logon no computador e às credenciais Colheita e utilizar para propagar o comprometimento de outros sistemas.  
  
Embora pass-the-hash (PTH) e outros ataques de roubo de credenciais são onipresentes hoje em dia, é porque não há ferramentas disponíveis gratuitamente que torna mais simples e fácil extrair as credenciais de outras contas privilegiadas quando um invasor tenha obtido acesso de nível de administrador ou sistema a um computador. Mesmo sem ferramentas que permite a coleta de credenciais de sessões de logon, um invasor com acesso privilegiado para um computador de maneira tão fácil pode instalar digitação que capturam o conteúdo da área de transferência, capturas de tela e pressionamentos de teclas. Um invasor com acesso privilegiado para um computador pode desabilitar o software antimalware, instalar rootkits, modificar arquivos protegidos ou instalar um malware no computador que automatiza a ataques ou ativa um servidor em um [download drive-by](https://www.microsoft.com/security/sir/glossary/drive-by-download-sites.aspx) host.  
  
As táticas usadas para estender uma violação além de um único computador variam, mas a chave para propagar comprometimento é a aquisição de altamente privilegiado acesso aos sistemas adicionais. Reduzindo o número de contas com acesso privilegiado para qualquer sistema, você reduzir a superfície de ataque não apenas de computador, mas a probabilidade de um invasor coleta valiosas credenciais do computador.  
  
##### <a name="standardizing-local-administrator-credentials"></a>Padronizar as credenciais de Administrador Local  
Tempo houve debate entre especialistas em segurança, se houver valor na renomeando contas de administrador locais em computadores com Windows. O que é realmente importante sobre as contas de administrador locais é se eles são configurados com o mesmo nome de usuário e senha em vários computadores.  
  
Se a conta de administrador local é chamada para o mesmo valor em todos os servidores e a senha atribuída à conta também está configurada para o mesmo valor, invasores podem extrair as credenciais da conta em um computador no qual administrador ou no nível do sistema foi obtido acesso. O invasor não precisa comprometer inicialmente a conta de administrador; eles só precisam comprometer a conta de um usuário que seja um membro do grupo Administradores local ou de uma conta de serviço que está configurada para execução como sistema local ou com privilégios de administrador. O invasor pode extrair as credenciais da conta de administrador e repetir essas credenciais em logons de rede para outros computadores na rede.  
  
Contanto que outro computador tenha uma conta local com o mesmo nome de usuário e senha (ou hash da senha) como as credenciais da conta que estão sendo apresentadas, a tentativa de logon é bem-sucedida e o invasor obtém acesso privilegiado ao computador de destino. Nas versões atuais do Windows, a conta de administrador interno é [desabilitado por padrão](https://technet.microsoft.com/library/cc753450.aspx), mas em sistemas operacionais herdados, a conta é habilitada por padrão.  
  
> [!NOTE]  
> Algumas organizações intencionalmente configurou as contas de administrador locais para ser habilitado na crença de que isso fornece uma "à prova de falha", no caso de todas as outras contas privilegiadas são bloqueadas em um sistema. No entanto, mesmo que a conta de administrador local está desabilitada e não há nenhum outras contas disponíveis que podem habilitar a conta ou fazer logon no sistema com privilégios de administrador, o sistema pode ser inicializado no modo de segurança e a conta de administrador local interno pode ser habilitada novamente, conforme descrito em [artigo Microsoft Support 814777](https://support.microsoft.com/kb/814777). Além disso, se ainda com êxito o sistema aplica-se GPOs, um GPO pode ser modificado para reabilitar (temporariamente) a conta de administrador ou grupos restritos pode ser configurados para adicionar uma conta de domínio ao grupo Administradores local. Reparos podem ser executados e a conta de administrador novamente pode ser desabilitada. Para efetivamente impedir que um comprometimento lateral que usa credenciais de conta de administrador locais internas, senhas e nomes de usuário exclusivos devem ser definidas para contas de administrador locais. Para implantar senhas exclusivas para contas de administrador locais por meio de um GPO, consulte [solução de gerenciamento de senha da conta de administrador interno por meio do GPO](https://technet.microsoft.com/mt227395.aspx) no technet.  
  
##### <a name="permitting-installation-of-unauthorized-applications"></a>Permitindo a instalação de aplicativos não autorizados  
*Lei número um: Se uma pessoa mal-intencionada pode convençam para executar um programa no computador, não é exclusivamente seu computador mais.* - [Dez leis imutáveis de segurança (versão 2.0)](https://technet.microsoft.com/security/hh278941.aspx)  
  
Se uma organização implante configurações de linha de base consistente em todos os servidores, a instalação de aplicativos que não fazem parte da função definida do servidor não deve ser permitida. Permitindo que o software ser instalado que não faz parte da funcionalidade designado do servidor, servidores são expostos a instalação mal-intencionado ou inadvertida do software que aumenta a superfície de ataque do servidor, apresenta vulnerabilidades do aplicativo ou causa instabilidade no sistema.  
  
#### <a name="applications"></a>Aplicativos  
Conforme descrito anteriormente, aplicativos geralmente instalados e configurados para usar contas que são concedidas que realmente exige um privilégio mais do que o aplicativo. Em alguns casos, a documentação do aplicativo especifica que contas de serviço devem ser membros do grupo Administradores local de um servidor ou devem ser configuradas para ser executado no contexto do sistema local. Isso é geralmente não porque o aplicativo requer esses direitos, mas como determinar quais direitos e permissões de necessidade de contas de serviço de um aplicativo requer investimento em mais tempo e esforço. Se um aplicativo não for instalado com os privilégios mínimos necessários para o aplicativo e seus recursos configurados funcionar, o sistema é exposto a ataques que aproveitam os privilégios do aplicativo sem qualquer ataque contra o sistema operacional em si.  
  
### <a name="lack-of-secure-application-development-practices"></a>Falta de práticas de desenvolvimento de aplicativos seguros  
Infraestrutura existe para dar suporte a cargas de trabalho de negócios. Quando essas cargas de trabalho são implementadas em aplicativos personalizados, é importante garantir que os aplicativos são desenvolvidos usando práticas recomendadas seguras. Análise de causas raiz de toda a empresa incidentes revela muitas vezes que um comprometimento inicial é afetado por meio de personalizado aplicativos especialmente aqueles que são Internet opostas. A maioria desses comprometimentos é executada por meio de comprometimento de ataques bem conhecidos como injeção de SQL (SQLi) e ataques de cross-site scripting (XSS).  
  
Injeção de SQL é uma vulnerabilidade de aplicativo que permite a entrada definida pelo usuário para modificar uma instrução SQL que é passada para o banco de dados para execução. Essa entrada pode ser fornecida por meio de um campo no aplicativo, um parâmetro (como a cadeia de caracteres de consulta ou um cookie) ou outros métodos. O resultado deste injeção é que a instrução SQL fornecida para o banco de dados é fundamentalmente diferente do que o desenvolvedor deve. Veja, por exemplo, uma consulta comum usada na avaliação de uma combinação de nome/senha de usuário:  
  
`SELECT userID FROM users WHERE username = 'sUserName' AND password = 'sPassword'`  
  
Quando isso é recebido pelo servidor de banco de dados, ele instrui o servidor para examinar a tabela de usuários e retornar qualquer registro userID corresponder àquelas fornecidas pelo usuário (presumivelmente por meio de um formulário de logon de algum tipo) onde o nome de usuário e senha. Naturalmente a intenção do desenvolvedor neste caso é apenas retornar um registro válido e se um nome de usuário correto e uma senha podem ser fornecidas pelo usuário. Se nenhuma estiver incorreto, o servidor de banco de dados será impossível encontrar um registro correspondente e retornar o resultado será vazio.  
  
O problema ocorre quando um invasor faz algo inesperado como o fornecimento de seu próprios SQL no lugar de dados válidos. Como SQL é interpretado no interrupções pelo servidor de banco de dados, o código injetado seria processado como se o desenvolvedor tivesse colocá-lo em si. Por exemplo, se o invasor inserido **administrador** para a ID de usuário e **xyz** ou **1 = 1** como a senha, a instrução resultante processada pelo banco de dados seria:  
  
`SELECT userID FROM users WHERE username = 'administrator' AND password = 'xyz' OR 1=1`  
  
Quando essa consulta é processada pelo servidor de banco de dados, todas as linhas na tabela serão retornadas na consulta porque 1 = 1 sempre será avaliado como True, portanto, não importa se o nome de usuário correto e a senha é conhecida ou fornecido. O resultado na maioria dos casos é que o usuário será registrado como o primeiro usuário no banco de dados do usuário; Na maioria dos casos, esse será o usuário administrativo.  
  
Além de simplesmente logon, instruções SQL malformadas, como isso pode ser usado para adicionar, excluir, alterar os dados ou até mesmo soltar tabelas inteiras (excluir) de um banco de dados. Nos casos mais exigentes onde SQLi é combinado com privilégios excessivos, os comandos do sistema operacional podem ser executados para habilitar a criação de novos usuários, para baixar as ferramentas de ataque, ou para fazer outras ações dos invasores.  
  
No script entre sites, a vulnerabilidade é apresentada na saída do aplicativo. Um ataque começa com um invasor que fornece dados malformados ao aplicativo, mas nesse caso dados malformados são na forma de código de script (como JavaScript) que será executado pelo navegador da vítima. Exploração de uma vulnerabilidade XSS pode permitir que um invasor todas as funções do aplicativo de destino são executados no contexto do usuário que iniciou o navegador. Ataques XSS normalmente são iniciadas por um email de phishing incentivar o usuário clicar em um link que se conecta ao aplicativo e executa o código de ataque.  
  
XSS é geralmente explorado em cenários de comércio eletrônico, em que um invasor pode fazer compras ou transferir dinheiro no contexto do usuário explorado e transações bancárias online. No caso de um ataque de destino em um aplicativo de gerenciamento de identidade personalizadas baseadas na web, ele pode permitir que um invasor crie suas próprias identidades, modificar direitos e permissões e levar a um comprometimento sistemático.  
  
Embora uma discussão completa de injeção de SQL e script entre sites está fora do escopo deste documento, o [aberta da Web Application segurança projeto (OWASP)](https://www.owasp.org/index.php/Main_Page) publica uma lista de 10 principais com discussão detalhada das vulnerabilidades e contramedidas.  
  
Independentemente dos investimentos em segurança de infraestrutura, se mal projetados e escritos aplicativos são implantados nessa infraestrutura, o ambiente é feito vulnerável a ataques. Mesmo bem protegidas infraestruturas geralmente não podem fornecer contramedidas eficientes para esses ataques de aplicativo. O problema de composição, aplicativos mal projetados podem exigir que contas de serviço ser concedido permissões excessivas para o aplicativo à função.  
  
O Microsoft Security Development Lifecycle (SDL) é um conjunto de controles de processo estruturais que funcionam para melhorar o início de segurança no início requisitos coletando e estendendo durante o ciclo de vida do aplicativo até que ele é encerrado. Essa integração dos controles de segurança efetiva não é apenas crítica de uma perspectiva de segurança, é importante garantir a segurança do aplicativo é custo e agendar eficaz. Avaliação de um aplicativo para problemas de segurança quando ele está efetivamente código completo exige que as empresas para tomar decisões sobre a segurança do aplicativo apenas antes ou até mesmo depois que o aplicativo tenha sido implantado. Uma organização pode optar por lidar com as falhas de aplicativo antes de implantar o aplicativo em produção, Incorrência de custos e atrasos, ou o aplicativo pode ser implantado em produção com falhas de segurança conhecidas, expondo a organização de comprometer.  
  
Algumas organizações colocar o custo total de corrigindo um problema de segurança no código de produção acima de US $10.000 por problema e aplicativos desenvolvidos sem um SDL eficaz podem média de mais de dez problemas de gravidade alto por 100.000 linhas de código. Em grandes aplicativos, os custos encaminhar rapidamente. Por outro lado, muitas empresas defina um parâmetro de comparação de menos de um problema por 100.000 linhas de código no estágio de análise de código final do SDL e tenha como objetivo zero problemas em aplicativos de alto risco em produção.  
  
Implementação do SDL melhora a segurança, incluindo requisitos de segurança no início de reunião de requisitos e design de um aplicativo fornece para aplicativos de alto risco; de modelagem de ameaças requer treinamento efetivação e monitoramento de desenvolvedores; e clara e requer código consistente padrões e práticas recomendadas. O resultado de um SDL é melhorias significativas na segurança de aplicativo reduzindo o custo para desenvolver, implantar, manter e encerrar um aplicativo. Embora uma discussão detalhada sobre o design e implementação de SDL estão além do escopo deste documento, consulte o [ciclo de vida de desenvolvimento do Microsoft Security](https://www.microsoft.com/security/sdl/default.aspx) para obter orientações detalhadas e informações.  
  


